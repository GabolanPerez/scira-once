@model IEnumerable<SCIRA.Models.k_certificacion_control>
@using SCIRA.Utilidades
@{
    ViewBag.Title = "Reporte Certificación";
    Layout = "~/Views/Shared/_LayoutReporte.cshtml";
    SCIRA.Models.SICIEntities db = new SCIRA.Models.SICIEntities();
}

<h2>@Strings.getMSG("ReporteCertificacionIndex001")</h2>

<table class="results table table-striped table-bordered table-hover">
    <thead>
        <tr>
            <th class="search">@Strings.getMSG("Entidad")</th>
            <th class="search">@Strings.getMSG("ReporteEstructuraIndex001")</th>
            <th class="search">@Strings.getMSG("P")</th>
            <th class="search">@Strings.getMSG("MP")</th>
            <th class="search">@Strings.getMSG("ReporteEstructuraIndex002")</th>
            <th class="search">@Strings.getMSG("ReporteEstructuraIndex003")</th>
            <th class="search">@Strings.getMSG("SP")</th>
            <th class="search">@Strings.getMSG("RiesgoCreate037")</th>
            <th class="search">@Strings.getMSG("RiesgoRiesgos002")</th>
            <th class="search">@Strings.getMSG("EventoRiesgoIndex001")</th>
            <th class="search">@Strings.getMSG("RiesgoCreate084")</th>
            <th class="search">@Strings.getMSG("ReporteCertificacionIndex002")</th>
            <th class="search">@Strings.getMSG("ReporteCertificacionIndex003")</th>
            <th class="search">@Strings.getMSG("PeriodoCertificacionIndex002")</th>
            <th class="search">@Strings.getMSG("CertificacionCertificar002")</th>
            <th class="search">@Strings.getMSG("Menu010")</th>
            <th class="search">@Strings.getMSG("ReporteCertificacionIndex004")</th>
            <th class="search">@Strings.getMSG("ReporteCertificacionIndex005")</th>
            <th class="search">@Strings.getMSG("ReporteCertificacionIndex006")</th>
            <th class="search">@Strings.getMSG("ReporteCertificacionIndex007") </th>
            <th class="search">@Strings.getMSG("CertificacionInforme028")</th>
            <th class="search">@Strings.getMSG("ReporteCertificacionIndex008")</th>
            <th class="search">@Strings.getMSG("ReporteCertificacionIndex009")</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            var control = item.k_control;
            var riesgo = control.k_riesgo.First();
            var sp = control.c_sub_proceso;
            var pr = sp.c_proceso;
            var mp = pr.c_macro_proceso;
            var en = mp.c_entidad;
            var respPr = pr.c_usuario;
            var respMp = mp.c_usuario;
            var respEn = en.c_usuario;
            var respSp = sp.c_usuario;


        <tr>
            <td>@(en.cl_entidad + " - " + en.nb_entidad)</td>
            <td>@(respEn.nb_usuario)</td>
            <td>@(mp.cl_macro_proceso + " - " + mp.nb_macro_proceso)</td>
            <td>@(respMp.nb_usuario)</td>
            <td>@(pr.cl_proceso + " - " + pr.nb_proceso)</td>
            <td>@(respPr.nb_usuario)</td>
            <td>@(sp.cl_sub_proceso + " - " + sp.nb_sub_proceso)</td>
            <td>@(respSp.nb_usuario)</td>
            <td>@(riesgo.nb_riesgo)</td>
            <td>@(riesgo.evento)</td>
            <td>@(control.relacion_control)</td>
            @if (control.tiene_accion_correctora)
            {
                <td><b>@Strings.getMSG("RiesgoCreate120") </b>@(control.accion_correctora)</td>
            }
            else
            {
                <td>@(control.actividad_control)</td>
            }
            <td>@(item.cl_certificacion_control)</td>
            <td>@(item.c_periodo_certificacion.nb_periodo_certificacion + " - " + item.c_periodo_certificacion.anio)</td>
            <td>@(item.ds_procedimiento_certificacion)</td>
            <td>@(item.c_tipo_evaluacion.nb_tipo_evaluacion)</td>
            <td>@(item.no_partidas_minimo)</td>
            <td>@(item.no_partidas_semestre1)</td>
            <td>@(item.no_partidas_semestre2)</td>
            <td>@(item.no_pruebas_realizadas)</td>
            <td>@(item.tiene_funcionamiento_efectivo ? Strings.getMSG("UsuarioIndex004"):Strings.getMSG("UsuarioIndex005"))</td>
            <td>@(item.tiene_disenio_efectivo ? Strings.getMSG("UsuarioIndex004"):Strings.getMSG("UsuarioIndex005"))</td>
            <td>@((item.nb_archivo_1 != null || item.nb_archivo_2 != null || item.nb_archivo_3 != null || item.nb_archivo_4 != null || item.nb_archivo_5 != null) ? Strings.getMSG("UsuarioIndex004"):Strings.getMSG("UsuarioIndex005"))</td>
        </tr>
        }
    </tbody>
</table>
