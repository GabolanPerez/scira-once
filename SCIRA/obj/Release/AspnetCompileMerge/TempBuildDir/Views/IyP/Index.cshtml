@using SCIRA.Models
@using SCIRA.Utilidades
@{
    Layout = "~/Views/Shared/_LayoutIndex.cshtml";
    ViewBag.Title = "Index";
    List<k_objeto> Oficios = ViewBag.Oficios;
    List<k_objeto> AuExt = ViewBag.AuExt;
    List<k_objeto> AuInt = ViewBag.AuInt;
    List<k_certificacion_control> Certificacion = ViewBag.Certificacion;
    List<k_control> MRyC = ViewBag.MRyC;
    List<k_objeto> Otros = ViewBag.Otros;
}

<script src="~/Scripts/Certificacion.js"></script>
<link href="~/Content/bootstrap-select.min.css" rel="stylesheet" />
<script src="~/Scripts/bootstrap-select.js"></script>

<link href="~/Content/base.css" rel="stylesheet" />
<link href="~/Content/bootstrap-datetimepicker.css" rel="stylesheet" />

<script type="text/javascript" src="~/Scripts/moment-with-locales.js"></script>
<script type="text/javascript" src="~/Scripts/bootstrap-datetimepicker.js"></script>
<link href="~/Content/font-awesome.min.css" rel="stylesheet" />
<link href="~/Content/Extras.css" rel="stylesheet" />

<!-- #region Oficios -->
<script>
    //Oficio
    function indexOficio() {
        $("#ind1").addClass("IndicatorLoader");
        $("#contenedor1").load('@(Url.Action("IndexOficio", "IyP", null))');
        $(".popover").hide();
    }
    function createOficio() {
        $("#ind1").addClass("IndicatorLoader");
        $("#contenedor1").load('@(Url.Action("CreateOficio", "IyP", null))');
    }
    function createOficioPost() {
        $("#ind1").addClass("IndicatorLoader");

        var form = $("#form1")[0];
        var data = new FormData(form);

        $.ajax({
            dataType: "html",
            type: "post",
            enctype: 'multipart/form-data',
            processData: false,  // Important!
            contentType: false,
            cache: false,
            url: '@(Url.Action("CreateOficio", "IyP"))',
            data: data,
            success: function (data) {
                $("#contenedor1").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexOficio();
            }
        });
    }
    function editOficio(id) {
        $("#ind1").addClass("IndicatorLoader");
        $("#contenedor1").load('@(Url.Action("EditOficio", "IyP", null))?id='+id);
    }
    function editOficioPost() {
        $("#ind1").addClass("IndicatorLoader");


        var form = $("#form1")[0];
        var data = new FormData(form);

        $.ajax({
            dataType: "html",
            type: "post",
            enctype: 'multipart/form-data',
            processData: false,  // Important!
            contentType: false,
            cache: false,
            url: '@(Url.Action("EditOficio", "IyP"))',
            data: data,
            success: function (data) {
                $("#contenedor1").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexOficio();
            }
        });
    }
    function deleteOficio(id) {
        $("#ind1").addClass("IndicatorLoader");
        $("#contenedor1").load('@(Url.Action("DeleteOficio", "IyP", null))?id=' + id);
    }
    function deleteOficioPost() {
        $("#ind1").addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("DeleteOficio", "IyP"))',
            data: $("#form1").serialize(),
            success: function (data) {
                $("#contenedor1").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexOficio();
            }
        });
    }
    function oficiosRelacionados(id,nb_oficio) {
        $("#modalB").load('@(Url.Action("OficiosRelacionados", "IyP", null))?id=' + id);
        $("#modalH").html("<center><h3 style='color:white;'>@Strings.getMSG("lyPIndex030") " + nb_oficio + "</h3></center>");
        $("#aviso").modal('show');
    }
</script>
<!-- #endregion -->
<!-- #region AuExt -->
<script>
    //AuExt
    function indexAuExt() {
        $("#ind2").addClass("IndicatorLoader");
        $("#contenedor2").load('@(Url.Action("IndexAuExt", "IyP", null))');
        $(".popover").hide();
    }
    function createAuExt() {
        $("#ind2").addClass("IndicatorLoader");
        $("#contenedor2").load('@(Url.Action("CreateAuExt", "IyP", null))');
    }
    function createAuExtPost() {
        $("#ind2").addClass("IndicatorLoader");

        var form = $("#form2")[0];
        var data = new FormData(form);

        $.ajax({
            dataType: "html",
            type: "post",
            enctype: 'multipart/form-data',
            processData: false,  // Important!
            contentType: false,
            cache: false,
            url: '@(Url.Action("CreateAuExt", "IyP"))',
            data: data,
            success: function (data) {
                $("#contenedor2").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexAuExt();
            }
        });
    }
    function editAuExt(id) {
        $("#ind2").addClass("IndicatorLoader");
        $("#contenedor2").load('@(Url.Action("EditAuExt", "IyP", null))?id='+id);
    }
    function editAuExtPost() {
        $("#ind2").addClass("IndicatorLoader");

        var form = $("#form2")[0];
        var data = new FormData(form);

        $.ajax({
            dataType: "html",
            type: "post",
            enctype: 'multipart/form-data',
            processData: false,  // Important!
            contentType: false,
            cache: false,
            url: '@(Url.Action("EditAuExt", "IyP"))',
            data: data,
            success: function (data) {
                $("#contenedor2").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexAuExt();
            }
        });
    }
    function deleteAuExt(id) {
        $("#ind2").addClass("IndicatorLoader");
        $("#contenedor2").load('@(Url.Action("DeleteAuExt", "IyP", null))?id=' + id);
    }
    function deleteAuExtPost() {
        $("#ind2").addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("DeleteAuExt", "IyP"))',
            data: $("#form2").serialize(),
            success: function (data) {
                $("#contenedor2").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexAuExt();
            }
        });
    }
</script>
<!-- #endregion -->
<!-- #region AuInt -->
<script>
    //AuInt
    function indexAuInt() {
        $("#ind3").addClass("IndicatorLoader");
        $("#contenedor3").load('@(Url.Action("IndexAuInt", "IyP", null))');
        $(".popover").hide();
    }
    function createAuInt() {
        $("#ind3").addClass("IndicatorLoader");
        $("#contenedor3").load('@(Url.Action("CreateAuInt", "IyP", null))');
    }
    function createAuIntPost() {
        $("#ind3").addClass("IndicatorLoader");

        var form = $("#form3")[0];
        var data = new FormData(form);

        $.ajax({
            dataType: "html",
            type: "post",
            enctype: 'multipart/form-data',
            processData: false,  // Important!
            contentType: false,
            cache: false,
            url: '@(Url.Action("CreateAuInt", "IyP"))',
            data: data,
            success: function (data) {
                $("#contenedor3").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexAuInt();
            }
        });
    }
    function editAuInt(id) {
        $("#ind3").addClass("IndicatorLoader");
        $("#contenedor3").load('@(Url.Action("EditAuInt", "IyP", null))?id='+id);
    }
    function editAuIntPost() {
        $("#ind3").addClass("IndicatorLoader");

        var form = $("#form3")[0];
        var data = new FormData(form);

        $.ajax({
            dataType: "html",
            type: "post",
            enctype: 'multipart/form-data',
            processData: false,  // Important!
            contentType: false,
            cache: false,
            url: '@(Url.Action("EditAuInt", "IyP"))',
            data: data,
            success: function (data) {
                $("#contenedor3").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexAuInt();
            }
        });
    }
    function deleteAuInt(id) {
        $("#ind3").addClass("IndicatorLoader");
        $("#contenedor3").load('@(Url.Action("DeleteAuInt", "IyP", null))?id=' + id);
    }
    function deleteAuIntPost() {
        $("#ind3").addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("DeleteAuInt", "IyP"))',
            data: $("#form3").serialize(),
            success: function (data) {
                $("#contenedor3").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexAuInt();
            }
        });
    }
</script>
<!-- #endregion -->
<!-- #region Cert -->
<script>
    //Cert
    function indexCert() {
        $("#ind4").addClass("IndicatorLoader");
        $("#contenedor4").load('@(Url.Action("IndexCert", "IyP", null))');
    }
</script>
<!-- #endregion -->
<!-- #region MRyC -->
<script>
     //MRyC
    function indexMRyC() {
        $("#ind5").addClass("IndicatorLoader");
        $("#contenedor5").load('@(Url.Action("IndexMRyC", "IyP", null))');
    }
</script>
<!-- #endregion -->
<!-- #region Otros -->
<script>
     //Otros
    function indexOtros() {
        $("#ind6").addClass("IndicatorLoader");
        $("#contenedor6").load('@(Url.Action("IndexOtros", "IyP", null))');
        $(".popover").hide();
    }
    function createOtros() {
        $("#ind6").addClass("IndicatorLoader");
        $("#contenedor6").load('@(Url.Action("CreateOtros", "IyP", null))');
    }
    function createOtrosPost() {
        $("#ind6").addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("CreateOtros", "IyP"))',
            data: $("#form6").serialize(),
            success: function (data) {
                $("#contenedor6").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexAuInt();
            }
        });
    }
    function editOtros(id) {
        $("#ind6").addClass("IndicatorLoader");
        $("#contenedor6").load('@(Url.Action("EditOtros", "IyP", null))?id='+id);
    }
    function editOtrosPost() {
        $("#ind6").addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("EditOtros", "IyP"))',
            data: $("#form6").serialize(),
            success: function (data) {
                $("#contenedor6").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexOtros();
            }
        });
    }
    function deleteOtros(id) {
        $("#ind6").addClass("IndicatorLoader");
        $("#contenedor6").load('@(Url.Action("DeleteOtros", "IyP", null))?id=' + id);
    }
    function deleteOtrosPost() {
        $("#ind6").addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("DeleteOtros", "IyP"))',
            data: $("#form6").serialize(),
            success: function (data) {
                $("#contenedor6").html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                indexOtros();
            }
        });
    }
</script>
<!-- #endregion -->
<!-- #region Incidencias -->
<script>
     //Incidencias
    function indexIncidencias(origen,id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor" + origen).load('@(Url.Action("listaIncidencias", "IyP", null))?id=' + id + '&Origen=' + origen);
        $(".popover").hide();
    }
    function createIncidencia(origen,id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor"+origen).load('@(Url.Action("CreateIncidencia", "IyP", null))?id=' + id + '&Origen=' + origen);
    }
    function createIncidenciaPost(origen) {
        $("#ind" + origen).addClass("IndicatorLoader");

        var form = $("#form" + origen)[0];
        var data = new FormData(form);

        $.ajax({
            dataType: "html",
            type: "post",
            enctype: 'multipart/form-data',
            processData: false,  // Important!
            contentType: false,
            cache: false,
            url: '@(Url.Action("CreateIncidencia", "IyP"))',
            data: data,
            success: function (data) {
                $("#contenedor" + origen).html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (origen == 1) indexOficio();
                if (origen == 2) indexAuExt();
                if (origen == 3) indexAuInt();
                if (origen == 4) indexCert();
                if (origen == 5) indexMRyC();
                if (origen == 6) indexOtros();
            }
        });
    }
    function editIncidencia(origen,id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor"+origen).load('@(Url.Action("EditIncidencia", "IyP", null))?id=' + id + '&Origen=' + origen);
    }
    function editIncidenciaPost(origen) {
        $("#ind" + origen).addClass("IndicatorLoader");

        var form = $("#form" + origen)[0];
        var data = new FormData(form);

        $.ajax({
            dataType: "html",
            type: "post",
            enctype: 'multipart/form-data',
            processData: false,  // Important!
            contentType: false,
            cache: false,
            url: '@(Url.Action("EditIncidencia", "IyP"))',
            data: data,
            success: function (data) {
                $("#contenedor" + origen).html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (origen == 1) indexOficio();
                if (origen == 2) indexAuExt();
                if (origen == 3) indexAuInt();
                if (origen == 4) indexCert();
                if (origen == 5) indexMRyC();
                if (origen == 6) indexOtros();
            }
        });
    }
    function deleteIncidencia(origen,id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor"+origen).load('@(Url.Action("DeleteIncidencia", "IyP", null))?id=' + id + '&Origen=' + origen);
    }
    function deleteIncidenciaPost(origen) {
        $("#ind" + origen).addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("DeleteIncidencia", "IyP"))',
            data: $("#form" + origen).serialize(),
            success: function (data) {
                $("#contenedor" + origen).html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (origen == 1) indexOficio();
                if (origen == 2) indexAuExt();
                if (origen == 3) indexAuInt();
                if (origen == 4) indexCert();
                if (origen == 5) indexMRyC();
                if (origen == 6) indexOtros();
            }
        });
    }
</script>
<!-- #endregion -->
<!-- #region Planes -->
<script>
    //Planes
    function indexPlanes(origen,id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor" + origen).load('@(Url.Action("IndexPlanes", "IyP", null))?id=' + id + '&Origen=' + origen);
        $(".popover").hide();
    }
    function createPlan(origen,id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor"+origen).load('@(Url.Action("CreatePlan", "IyP", null))?id=' + id + '&Origen=' + origen);
    }
    function createPlanPost(origen) {
        $("#ind" + origen).addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("CreatePlan", "IyP"))',
            data: $("#form" + origen).serialize(),
            success: function (data) {
                $("#contenedor" + origen).html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (origen == 1) indexOficio();
                if (origen == 2) indexAuExt();
                if (origen == 3) indexAuInt();
                if (origen == 4) indexCert();
                if (origen == 5) indexMRyC();
                if (origen == 6) indexOtros();
            }
        });
    }
    function editPlan(origen,id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor"+origen).load('@(Url.Action("EditPlan", "IyP", null))?id=' + id + '&Origen=' + origen);
    }
    function editPlanPost(origen) {
        $("#ind" + origen).addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("EditPlan", "IyP"))',
            data: $("#form" + origen).serialize(),
            success: function (data) {
                $("#contenedor" + origen).html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (origen == 1) indexOficio();
                if (origen == 2) indexAuExt();
                if (origen == 3) indexAuInt();
                if (origen == 4) indexCert();
                if (origen == 5) indexMRyC();
                if (origen == 6) indexOtros();
            }
        });
    }
    function deletePlan(origen,id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor"+origen).load('@(Url.Action("DeletePlan", "IyP", null))?id=' + id + '&Origen=' + origen);
    }
    function deletePlanPost(origen) {
        $("#ind" + origen).addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("DeletePlan", "IyP"))',
            data: $("#form" + origen).serialize(),
            success: function (data) {
                $("#contenedor" + origen).html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (origen == 1) indexOficio();
                if (origen == 2) indexAuExt();
                if (origen == 3) indexAuInt();
                if (origen == 4) indexCert();
                if (origen == 5) indexMRyC();
                if (origen == 6) indexOtros();
            }
        });
    }
</script>
<!-- #endregion -->
<!-- #region Seguimiento -->
<script>
    //Seguimiento
    function indexSeguimiento(origen,id) {
        $("#ind" + origen).addClass("IndicatorLoader");
        $("#contenedor" + origen).load('@(Url.Action("IndexSeguimiento", "IyP", null))?id=' + id + '&Origen=' + origen);
        $(".popover").hide();
    }
    function createSeguimiento(origen, id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor" + origen).load('@(Url.Action("CreateSeguimiento", "IyP", null))?id=' + id + '&Origen=' + origen);
    }
    function createSeguimientoPost(origen) {
        $("#ind" + origen).addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("CreateSeguimiento", "IyP"))',
            data: $("#form" + origen).serialize(),
            success: function (data) {
                $("#contenedor" + origen).html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (origen == 1) indexOficio();
                if (origen == 2) indexAuExt();
                if (origen == 3) indexAuInt();
                if (origen == 4) indexCert();
                if (origen == 5) indexMRyC();
                if (origen == 6) indexOtros();
            }
        });
    }
    function editSeguimiento(origen, id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor"+origen).load('@(Url.Action("EditSeguimiento", "IyP", null))?id=' + id + '&Origen=' + origen);
    }
    function editSeguimientoPost(origen) {
        $("#ind" + origen).addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("EditSeguimiento", "IyP"))',
            data: $("#form" + origen).serialize(),
            success: function (data) {
                $("#contenedor" + origen).html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                if (origen == 1) indexOficio();
                if (origen == 2) indexAuExt();
                if (origen == 3) indexAuInt();
                if (origen == 4) indexCert();
                if (origen == 5) indexMRyC();
                if (origen == 6) indexOtros();
            }
        });
    }
    function deleteSeguimiento(origen, id) {
        $("#ind"+origen).addClass("IndicatorLoader");
        $("#contenedor"+origen).load('@(Url.Action("DeleteSeguimiento", "IyP", null))?id=' + id + '&Origen=' + origen);
    }
    function deleteSeguimientoPost(origen) {
        $("#ind" + origen).addClass("IndicatorLoader");

        $.ajax({
            dataType: "html",
            type: "post",
            url: '@(Url.Action("DeleteSeguimiento", "IyP"))',
            data: $("#form" + origen).serialize(),
            success: function (data) {
                $("#contenedor" + origen).html(data);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                toastr.error(thrownError);
                if (origen == 1) indexOficio();
                if (origen == 2) indexAuExt();
                if (origen == 3) indexAuInt();
                if (origen == 4) indexCert();
                if (origen == 5) indexMRyC();
                if (origen == 6) indexOtros();
            }
        });
    }
</script>
<!-- #endregion -->
<!-- #region Scripts Auxiliares -->
<script>
    function activateDate(route) {

        $(route +" .datetimepicker").datetimepicker({
            locale: 'es',
            format: '@ViewBag.DateFormat',
            minDate: "01/01/1900"
        });
    }

    function getFichaO(id) {
        menuModal.initModal({
            title: 'Ficha',
            size: 'lg',
            show: true,
            loadUrl: '@Url.Action("Oficio","Ficha")/'+id
        });
    }

    function getFichaI(id) {
        menuModal.initModal({
            title: 'Ficha',
            size: 'lg',
            show: true,
            loadUrl: '@Url.Action("Incidencia","Ficha")/'+id
        });
    }

    function getFichaP(id) {
        menuModal.initModal({
            title: 'Ficha',
            size: 'lg',
            show: true,
            loadUrl: '@Url.Action("Plan","Ficha")/'+id
        });
    }
</script>
<!-- #endregion -->





<div class="modal fade" id="aviso" tabindex="-1" role="dialog" aria-labelledby="Aviso" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header" id="modalH">

            </div>
            <div id="modalB" class="modal-body">

            </div>
            <div class="modal-footer">

            </div>
        </div>
    </div>
</div>


<h2>@Strings.getMSG("Menu086")</h2>


<ul class="nav nav-tabs">
    <li class="active"><a href="#pes1" data-toggle="tab"><h4>@Strings.getMSG("Menu127") <span id="ind1"></span> </h4></a></li>
    <li><a href="#pes2" data-toggle="tab"><h4>@Strings.getMSG("lyPIndex001")<span id="ind2"></span></h4></a></li>
    <li><a href="#pes3" data-toggle="tab"><h4>@Strings.getMSG("lyPIndex002")<span id="ind3"></span></h4></a></li>
    <li><a href="#pes4" data-toggle="tab"><h4>@Strings.getMSG("Menu014")<span id="ind4"></span></h4></a></li>
    <li><a href="#pes5" data-toggle="tab"><h4>@Strings.getMSG("Menu077")<span id="ind5"></span></h4></a></li>
    <li><a href="#pes6" data-toggle="tab"><h4>@Strings.getMSG("ReporteIyPIndex021")<span id="ind6"></span></h4></a></li>
</ul>

<div id="myTabContent" class="tab-content">
    <div class="tab-pane fade active in" id="pes1">
        <br />
        <div class="form-horizontal well">
            <div id="contenedor1">

                <h4>@Strings.getMSG("Menu127")</h4>

                <p>
                    <input type="button" onclick="createOficio()" class="btn btn-default btn-sm" value="@Strings.getMSG("Agregar")" />
                </p>

                <table class="results table table-bordered table-striped table-hover table-responsive">
                    <thead>
                        <tr>
                            <th>@Strings.getMSG("lyPIndex029")</th>
                            <th>@Strings.getMSG("Entidad")</th>
                            <th>@Strings.getMSG("lyPIndex005")</th>
                            <th>@Strings.getMSG("lyPIndex006")</th>
                            <th>@Strings.getMSG("lyPIndex007")</th>
                            <th width="200px"></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Oficios)
                        {
                            <tr>
                                <td>@item.nb_objeto</td>
                                <td>@item.c_entidad.cl_entidad - @item.c_entidad.nb_entidad</td>
                                <td>@(item.fe_alta.HasValue ? item.fe_alta.Value.ToString("dd/MM/yyyy") : "")</td>
                                <td>@(item.fe_vencimiento.HasValue ? item.fe_vencimiento.Value.ToString("dd/MM/yyyy") : "")</td>
                                <td>@(item.fe_contestacion.HasValue ? item.fe_contestacion.Value.ToString("dd/MM/yyyy") : "")</td>
                                <td>
                                    <center>
                                        <center>
                                            @if (item.nb_archivo_1 != null)
                                            {
                                                <a href="@Url.Action("DescargaArchivo", new { id = item.id_objeto,index = 1 })">
                                                    <i class="fa fa-download fa-lg" title="@Strings.getMSG("Descargar copia del oficio")"></i>
                                                </a>
                                                <span>|</span>
                                            }
                                            @if (item.nb_archivo_2 != null)
                                            {
                                                <a href="@Url.Action("DescargaArchivo", new { id = item.id_objeto,index = 2 })">
                                                    <i class="fa fa-file-o fa-lg" title="@Strings.getMSG("ContestacionOficioIndex010")"></i>
                                                </a>
                                                <span>|</span>
                                            }
                                            @if (item.k_objeto2.Count() > 0 || item.k_objeto1.Count() > 0)
                                            {
                                                <a href="#" onclick="oficiosRelacionados(@item.id_objeto,'@item.nb_objeto')">
                                                    <i class="fa fa-link" title="@Strings.getMSG("Oficios Relacionados")" style="font-size: 16px;"></i>
                                                </a>
                                                <span>|</span>
                                            }
                                            <a>
                                                <i class="fa fa-id-card" title="@Strings.getMSG("Ficha")" onclick="getFichaO(@item.id_objeto)"></i>
                                            </a> |
                                            <a href="#" onclick="editOficio(@item.id_objeto)">
                                                <i class="fa fa-edit" title="@Strings.getMSG("Editar")" style="font-size: 16px;"></i>
                                            </a> |
                                            <a href="#" onclick="indexIncidencias(1,@item.id_objeto)">
                                                <i class="fa fa-exclamation-triangle" title="@Strings.getMSG("Incidencias") (@item.k_incidencia.Count())" style="font-size: 16px;"></i>
                                            </a> |
                                            <a href="#" onclick="deleteOficio(@item.id_objeto)">
                                                <i class="fa fa-trash" title="@Strings.getMSG("Borrar")" style="font-size: 16px;"></i>
                                            </a>
                                        </center>
                                    </center>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

            </div>
        </div>
    </div>

    <div class="tab-pane" id="pes2">
        <br />
        <div class="form-horizontal well">
            <div id="contenedor2">
                <h4>@Strings.getMSG("lyPInformesIndex001")</h4>

                <p>
                    <input type="button" onclick="createAuExt()" class="btn btn-default btn-sm" value="@Strings.getMSG("Agregar")" />
                </p>

                <table class="results table table-bordered table-striped table-hover table-responsive">
                    <thead>
                        <tr>
                            <th>@Strings.getMSG("lyPInformesIndex002")</th>
                            <th>@Strings.getMSG("Entidad")</th>
                            <th>@Strings.getMSG("lyPInformesIndex003")</th>
                            <th>@Strings.getMSG("lyPIndex007")</th>
                            <th width="120px"></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in AuExt)
                        {
                            <tr>
                                <td>@item.nb_objeto</td>
                                <td>@item.c_entidad.cl_entidad - @item.c_entidad.nb_entidad</td>
                                <td>@(item.fe_alta.HasValue  ? item.fe_alta.Value.ToString("dd/MM/yyyy"):"")</td>
                                <td>@(item.fe_contestacion.HasValue ? item.fe_contestacion.Value.ToString("dd/MM/yyyy") : "")</td>
                                <td>
                                    <center>
                                        @if (item.nb_archivo_1 != null)
                                        {
                                            <a href="@Url.Action("DescargaArchivo", new { id = item.id_objeto,index = 1 })">
                                                <i class="fa fa-download fa-lg" title="@Strings.getMSG("lyPInformesIndex005")"></i>
                                            </a>
                                            <span>|</span>
                                        }
                                        <a>
                                            <i class="fa fa-id-card" title="@Strings.getMSG("Ficha")" onclick="getFichaO(@item.id_objeto)"></i>
                                        </a> |
                                        <a href="#" onclick="editAuExt(@item.id_objeto)">
                                            <i class="fa fa-edit" title="@Strings.getMSG("Editar")" style="font-size: 16px;"></i>
                                        </a> |
                                        <a href="#" onclick="indexIncidencias(2,@item.id_objeto)">
                                            <i class="fa fa-exclamation-triangle" title="@Strings.getMSG("Incidencias") (@item.k_incidencia.Count())" style="font-size: 16px;"></i>
                                        </a> |
                                        <a href="#" onclick="deleteAuExt(@item.id_objeto)">
                                            <i class="fa fa-trash" title="@Strings.getMSG("Borrar")" style="font-size: 16px;"></i>
                                        </a>
                                    </center>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="tab-pane" id="pes3">
        <br />
        <div class="form-horizontal well">
            <div id="contenedor3">

                <h4>@Strings.getMSG("lyPInformesIndex001")</h4>

                <p>
                    <input type="button" onclick="createAuInt()" class="btn btn-default btn-sm" value="@Strings.getMSG("Agregar")" />
                </p>

                <table class="results table table-bordered table-striped table-hover table-responsive">
                    <thead>
                        <tr>
                            <th>@Strings.getMSG("lyPInformesIndex002")</th>
                            <th>@Strings.getMSG("Entidad")</th>
                            <th>@Strings.getMSG("lyPInformesIndex003")</th>
                            <th>@Strings.getMSG("lyPIndex007")</th>
                            <th width="120px"></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in AuInt)
                        {
                            <tr>
                                <td>@item.nb_objeto</td>
                                <td>@item.c_entidad.cl_entidad - @item.c_entidad.nb_entidad</td>
                                <td>@(item.fe_alta.HasValue ? item.fe_alta.Value.ToString("dd/MM/yyyy") : "")</td>
                                <td>@(item.fe_contestacion.HasValue ? item.fe_contestacion.Value.ToString("dd/MM/yyyy") : "")</td>
                                <td>
                                    <center>
                                        @if (item.nb_archivo_1 != null)
                                        {
                                            <a href="@Url.Action("DescargaArchivo", new { id = item.id_objeto,index = 1 })">
                                                <i class="fa fa-download fa-lg" title="@Strings.getMSG("lyPInformesIndex005")"></i>
                                            </a>
                                            <span>|</span>
                                        }
                                        <a>
                                            <i class="fa fa-id-card" title="@Strings.getMSG("Ficha")" onclick="getFichaO(@item.id_objeto)"></i>
                                        </a> |
                                        <a href="#" onclick="editAuInt(@item.id_objeto)">
                                            <i class="fa fa-edit" title="@Strings.getMSG("Editar")" style="font-size: 16px;"></i>
                                        </a> |
                                        <a href="#" onclick="indexIncidencias(3,@item.id_objeto)">
                                            <i class="fa fa-exclamation-triangle" title="@Strings.getMSG("Incidencias") (@item.k_incidencia.Count())" style="font-size: 16px;"></i>
                                        </a> |
                                        <a href="#" onclick="deleteAuInt(@item.id_objeto)">
                                            <i class="fa fa-trash" title="@Strings.getMSG("Borrar")" style="font-size: 16px;"></i>
                                        </a>
                                    </center>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="tab-pane" id="pes4">
        <br />
        <div class="form-horizontal well">
            <div id="contenedor4">

                <h4>@Strings.getMSG("lyPCertificacionesIndex001")</h4>

                <table class="results table table-bordered table-striped table-hover table-responsive">
                    <thead>
                        <tr>
                            <th class="search">@Strings.getMSG("lyPCertificacionesIndex002")</th>
                            <th class="search">@Strings.getMSG("RiesgoCreate084")</th>
                            <th class="search">@Strings.getMSG("lyPCertificacionesIndex003")</th>
                            <th class="search">@Strings.getMSG("PeriodoCertificacionIndex002")</th>
                            <th class="search">@Strings.getMSG("CertificacionCertificados001")</th>
                            <th width="80px"></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Certificacion)
                        {
                            <tr>
                                <td>@item.k_control.c_sub_proceso.c_proceso.c_macro_proceso.c_entidad.cl_entidad/@item.k_control.c_sub_proceso.c_proceso.c_macro_proceso.cl_macro_proceso/@item.k_control.c_sub_proceso.c_proceso.cl_proceso/@item.k_control.c_sub_proceso.cl_sub_proceso/@item.k_control.k_riesgo.First().nb_riesgo</td>
                                <td>@item.k_control.relacion_control</td>
                                <td>@item.cl_certificacion_control</td>
                                <td>@item.c_periodo_certificacion.nb_periodo_certificacion</td>
                                <td>@item.ds_procedimiento_certificacion</td>
                                <td>
                                    <center>
                                        <a href="#" onclick="indexIncidencias(4,@item.id_certificacion_control)">
                                            <i class="fa fa-exclamation-triangle" title="@Strings.getMSG("Incidencias") (@item.k_incidencia.Count())" style="font-size: 16px;"></i>
                                        </a>
                                    </center>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="tab-pane" id="pes5">
        <br />
        <div class="form-horizontal well">
            <div id="contenedor5">

                <h4>@Strings.getMSG("Menu077")</h4>

                <table class="results table table-bordered table-striped table-hover table-responsive">
                    <thead>
                        <tr>
                            <th class="search">@Strings.getMSG("lyPMRyCIndex001")</th>
                            <th class="search">@Strings.getMSG("RiesgoRiesgos002")</th>
                            <th class="search">@Strings.getMSG("RiesgoRiesgos003")</th>
                            <th class="search">@Strings.getMSG("RiesgoCreate079")</th>
                            <th width="80px"></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in MRyC)
                        {
                            var riesgo = item.k_riesgo.First();
                            <tr>
                                <td>@item.c_sub_proceso.c_proceso.c_macro_proceso.c_entidad.cl_entidad/@item.c_sub_proceso.c_proceso.c_macro_proceso.cl_macro_proceso/@item.c_sub_proceso.c_proceso.cl_proceso/@item.c_sub_proceso.cl_sub_proceso</td>
                                <td>@riesgo.nb_riesgo</td>
                                <td>@riesgo.evento</td>
                                <td>@item.accion_correctora</td>
                                <td>
                                    <center>
                                        <a href="#" onclick="indexIncidencias(5,@item.id_control)">
                                            <i class="fa fa-exclamation-triangle" title="@Strings.getMSG("Incidencias") (@item.k_incidencia.Count())" style="font-size: 16px;"></i>
                                        </a>
                                    </center>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="tab-pane" id="pes6">
        <br />
        <div class="form-horizontal well">
            <div id="contenedor6">

                <h4>@Strings.getMSG("ReporteIyPIndex021")</h4>

                <p>
                    <input type="button" onclick="createOtros()" class="btn btn-default btn-sm" value="@Strings.getMSG("Agregar")" />
                </p>

                <table class="results table table-bordered table-striped table-hover table-responsive">
                    <thead>
                        <tr>
                            <th class="search">@Strings.getMSG("lyPOtrosIndex001")</th>
                            <th class="search">@Strings.getMSG("Entidad")</th>
                            <th class="search">@Strings.getMSG("SubProcesoCreate018")</th>
                            <th class="search">@Strings.getMSG("lyPSeguimientosIndex002")</th>
                            <th width="80px"></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Otros)
                        {
                            <tr>
                                <td>@item.nb_objeto</td>
                                <td>@item.c_entidad.cl_entidad - @item.c_entidad.nb_entidad</td>
                                <td>@item.ds_objeto</td>
                                <td>@(item.fe_alta.HasValue ? item.fe_alta.Value.ToString("dd/MM/yyyy") : "")</td>
                                <td>
                                    <center>
                                        <a href="#" onclick="editOtros(@item.id_objeto)">
                                            <i class="fa fa-edit" title="@Strings.getMSG("Editar")" style="font-size: 16px;"></i>
                                        </a> |
                                        <a href="#" onclick="indexIncidencias(6,@item.id_objeto)">
                                            <i class="fa fa-exclamation-triangle" title="@Strings.getMSG("Incidencias") (@item.k_incidencia.Count())" style="font-size: 16px;"></i>
                                        </a> |
                                        <a href="#" onclick="deleteOtros(@item.id_objeto)">
                                            <i class="fa fa-trash" title="@Strings.getMSG("Borrar")" style="font-size: 16px;"></i>
                                        </a>
                                    </center>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>