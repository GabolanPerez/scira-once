
@model SCIRA.Models.k_auditoria
@using SCIRA.Utilidades
@{ 
    List<SCIRA.Models.c_campo_auditoria> InfoCamposExtraPA = ViewBag.InfoCamposExtraPA;
    List<SCIRA.Models.c_campo_auditoria> InfoCamposExtraEJ = ViewBag.InfoCamposExtraEJ;
    List<SCIRA.Models.c_campo_auditoria> InfoCamposExtra = ViewBag.InfoCamposExtra;
}

<script src="~/Scripts/jquery.validate.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.js"></script>

<link href="~/Content/bootstrap-select.min.css" rel="stylesheet" />
<script src="~/Scripts/bootstrap-select.js"></script>
<script src="~/Scripts/MSInitialize.js"></script>

<form id="Infaud">
    <div class="form-horizontal">

        <input type="hidden" name="idd_auditoria" value="@Model.idd_auditoria" />

        <center>
            <h4>@Strings.getMSG("ProcesosAuditoriaIndexInformes006")</h4>
        </center>

        <hr />

        <div class="row">
            <div class="radio col-md-6">
                <label>
                    <input type="radio" name="type" id="optionsRadios1" value="planeacion" checked>
                    @Strings.getMSG("ProcesosAuditoriaIndexInformes004")
                </label>
            </div>
            <div class="radio col-md-6">
                <label>
                    <input type="radio" name="type" id="optionsRadios2" value="informe">
                    @Strings.getMSG("Menu108")
                </label>
            </div>
        </div>
        


        <hr />

        <!-- #region Datos generales -->

        <center>
            <h5>@Strings.getMSG("Menu105")</h5>
        </center>


        <div class="row">
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("Entidad")</label>
                <input type="checkbox" name="en">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("Area")</label>
                <input type="checkbox" name="ar">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("AuditoriaIndexUniversoAuditable001")</label>
                <input type="checkbox" name="tp">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("AuditoriaIndexUniversoAuditable002")</label>
                <input type="checkbox" name="sl">
            </div>
        </div>
        <div class="row">

            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaCreatePlaneacion001")</label>
                <input type="checkbox" name="noaud">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaIndexInformes002")</label>
                <input type="checkbox" name="año">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaCreatePlaneacion002")</label>
                <input type="checkbox" name="feinp" checked>
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaCreatePlaneacion003")</label>
                <input type="checkbox" name="fefip" checked>
            </div>
        </div>

        @if (InfoCamposExtraPA.Count > 0)
        {
            <center>
                <p>@Strings.getMSG("ProcesosAuditoriaCreatePlaneacion014")</p>
            </center>
            <div class="row">
                @foreach (var campo in InfoCamposExtraPA)
                {
                    <div class="col-md-3">
                        <label class="control-label col-md-8">@campo.nb_campo</label>
                        <input type="checkbox" onclick="setval(this,@campo.id_campo_auditoria)">
                        <input type="hidden" name="idcampoe[]" value="@campo.id_campo_auditoria">
                        <input type="text" hidden name="campoe[]" id="ce@(campo.id_campo_auditoria)" value="off">
                    </div>
                }
            </div>
        }


        <!-- #endregion -->
        <!-- #region Planeación detallada -->
        <center>
            <hr />
            <h5>@Strings.getMSG("Planeación detallada")</h5>
        </center>

        <div class="row">
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaEditEjecucion003")</label>
                <input type="checkbox" name="ant">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaEditEjecucion004")</label>
                <input type="checkbox" name="datosr">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaEditEjecucion005")</label>
                <input type="checkbox" name="responsabler">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaEditEjecucion006")</label>
                <input type="checkbox" name="auditoresp">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaEditEjecucion007")</label>
                <input type="checkbox" name="feinr">
            </div>
            <div class="col-md-3">
                <label class="control-label col-md-8">@Strings.getMSG("ProcesosAuditoriaEditEjecucion008")</label>
                <input type="checkbox" name="fefir">
            </div>
        </div>

        @if (InfoCamposExtraEJ.Count > 0)
        {
            <center>
                <p>@Strings.getMSG("ProcesosAuditoriaCreatePlaneacion014")</p>
            </center>
            <div class="row">

                @foreach (var campo in InfoCamposExtraEJ)
                {
                    <div class="col-md-3">
                        <label class="control-label col-md-8">@campo.nb_campo</label>
                        <input type="checkbox" onclick="setval(this,@campo.id_campo_auditoria)">
                        <input type="hidden" name="idcampoe[]" value="@campo.id_campo_auditoria">
                        <input type="text" hidden name="campoe[]" id="ce@(campo.id_campo_auditoria)" value="off">
                    </div>
                }
            </div>
        }


        <!-- #endregion -->
        <!-- #region Informe -->
        <center>
            <hr />
            <h5>@Strings.getMSG("Menu108")</h5>
        </center>

        <div class="row">

            <div class="col-md-3">
                <label class="control-label col-md-8">Rating</label>
                <input type="checkbox" name="rat">
            </div>

            @foreach (var campo in InfoCamposExtra)
            {
                <div class="col-md-3">
                    <label class="control-label col-md-8">@campo.nb_campo</label>
                    <input type="checkbox" onclick="setval(this,@campo.id_campo_auditoria)">
                    <input type="hidden" name="idcampoe[]" value="@campo.id_campo_auditoria">
                    <input type="text" hidden name="campoe[]" id="ce@(campo.id_campo_auditoria)" value="off">
                </div>
            }
        </div>
        <!-- #endregion -->
    </div>

</form>


<div class="row">
    <br />
    <br />
    <div class="col-md-12">
        <input type="button" id="smtBtn" class="btn btn-primary pull-right" value="@Strings.getMSG("Generar Informe")" onclick="trySubmit()" />
        <input type="button" id="saveAsDefiniviteB" class="btn btn-default pull-left" value="@Strings.getMSG("Guardar como definitivo")" onclick="saveAsDef();" style="display:none;"/>
    </div>
</div>

<br />
<br />
<br />

<!-- #region Scripts -->
<script>
    var url = "@(Url.Action("GenInforme", "ProcesosAuditoria"))";

    function setval(cb, id) {
        if (cb.checked) {
            $("#ce" + id).val("on");
            //toastr.info("Checking ce" + id);
        } else {
            $("#ce" + id).val("off");
            //toastr.info("Unchecking ce" + id);
        }
    }

    var id;

    function trySubmit() {
        id = getFromURL(url, "Infaud");
        $("#menuModal .bodyContent").html('<span id="n"><embed src="@Url.Action("GetInforme","ProcesosAuditoria",null)/' + id + '" width="100%" height="700"></span>');
        $("#saveAsDefiniviteB").css("display","block");
    }

    function saveAsDef() {
        var res = getFromURL('@(Url.Action("SetInformeDef", "ProcesosAuditoria"))?id=' + id + '&idd_auditoria=@(Model.idd_auditoria)', null);

        if (res == "ok") {
            toastr.success('@Strings.getMSG("ProcesosAuditoriaEditInforme010")');
        }
    }

</script>
<!-- #endregion -->
