@model IEnumerable<SCIRA.Models.k_programa_trabajo>
@using SCIRA.Utilidades
@{
    List<SCIRA.Models.k_programa_trabajo> pendientes = Model.Where(m => !m.esta_atendida).ToList();
    List<SCIRA.Models.k_programa_trabajo> atendidas = Model.Where(m => m.esta_atendida).ToList();
}
<ul class="nav nav-tabs">
    <li class="active"><a href="#pes1" data-toggle="tab"><h4>@Strings.getMSG("AuditoriaIndexSeguimientoObservaciones005")</h4></a></li>
    <li><a href="#pes2" data-toggle="tab"><h4>@Strings.getMSG("AuditoriaIndexSeguimientoObservaciones006")</h4></a></li>
</ul>

<div id="myTabContent" class="tab-content">
    <div class="tab-pane fade active in" id="pes1">
        <br />
        <div class="form-horizontal well">
            <table class="results table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th>@Strings.getMSG("ProcesosAuditoriaIndexInformes002")</th>
                        <th>@Strings.getMSG("Entidad")</th>
                        <th>@Strings.getMSG("Menu148")</th>
                        <th>@Strings.getMSG("DivisionAuditoria001")</th>
                        <th>@Strings.getMSG("AuditoriaIndexUniversoAuditable002")</th>
                        <th>@Strings.getMSG("AuditoriaIndexSeguimientosPrograma004")</th>
                        <th>@Strings.getMSG("AuditoriaIndexSeguimientoObservaciones003")</th>
                        <th>@Strings.getMSG("Menu026")</th>
                        <th>@Strings.getMSG("BDEICreate005")</th>
                        <th>@Strings.getMSG("ProcesosAuditoriaEditPrueba004")</th>
                        <th>@Strings.getMSG("Responsable")</th>
                        <th>@Strings.getMSG("AuditoriaIndexSeguimientoObservaciones004")</th>
                        <th>@Strings.getMSG("lyPSeguimientoCreate002")</th>
                        <th>@Strings.getMSG("Seguimiento")</th>
                        <th>@Strings.getMSG("RevisionControlRevisiones003")</th>
                        <th>@Strings.getMSG("RevisionControlRevisiones007")</th>
                        <th width="40"></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in pendientes)
                    {
                        var criticidad = item.c_criticidad_programa_trabajo ?? new SCIRA.Models.c_criticidad_programa_trabajo();
                        var estatus = item.c_estatus_programa_trabajo ?? new SCIRA.Models.c_estatus_programa_trabajo();

                        var seguimientos = item.k_comentario_programa_trabajo;
                    <tr>
                        <td>
                            @item.k_auditoria.fe_inicial_planeada.Value.Year
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.k_auditoria.c_auditoria.c_entidad.nb_entidad)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.k_auditoria.c_auditoria.nb_auditoria)
                        </td>
                        <td>
                            @((item.k_auditoria.c_auditoria.id_division_auditoria ?? 0) != 0 ? item.k_auditoria.c_auditoria.c_division_auditoria.ds_division_auditoria : "N/A")
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.k_auditoria.c_auditoria.c_solicitante_auditoria.nb_solicitante_auditoria)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.incidencia_detectada)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.recomendaciones)
                        </td>
                        <td>
                            @(criticidad.nb_criticidad_programa_trabajo)
                        </td>
                        <td>
                            @(estatus.nb_estatus_programa_trabajo)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.tema)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.responsable)
                        </td>
                        <td>
                            @(item.es_duplicada ? Strings.getMSG("UsuarioIndex004"):Strings.getMSG("UsuarioIndex005"))
                        </td>
                        <td>
                            @item.comentarios
                        </td>
                        <td>
                            @foreach (var s in seguimientos)
                            {
                                <b>@string.Format("{0:dd/MM/yyyy}", s.fe_comentario)</b>
                                <p><i>@s.nb_responsable</i> @s.comentario</p><br />
                            }
                        </td>
                        <td>
                            @foreach (var file in item.c_archivo1)
                            {
                                <a href="@Url.Action("Download","Archivos", new { id = file.id_archivo})"><i class="fa fa-file@(Utilidades.getFileClass(file))" title="@file.nb_archivo"></i></a>
                            }
                            @if (item.c_archivo1.Count() == 0)
                            {
                                @Strings.getMSG("AuditoriaIndexSeguimientoObservaciones007")
                            }
                        </td>
                        <td>
                            @foreach (var file in item.c_archivo1)
                            {
                                <p>@(file.nb_archivo+"."+file.extension)</p>
                            }
                            @if (item.c_archivo1.Count() == 0)
                            {
                                @Strings.getMSG("AuditoriaIndexSeguimientoObservaciones007")
                            }
                        </td>
                        <td>
                            <a href="@Url.Action("EditSeguimientoObservaciones", new { id = item.idd_programa_trabajo })">
                                <i class="glyphicon glyphicon-pencil" title="@Strings.getMSG("Editar")"></i>
                            </a>
                            |
                            <a href="@Url.Action("IndexSeguimientosPrograma", new { id = item.idd_programa_trabajo })">
                                <i class="fa fa-paw" title="@Strings.getMSG("lyPSeguimientosIndex001")"></i>
                            </a>
                        </td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <div class="tab-pane" id="pes2">
        <br />
        <div class="form-horizontal well">
            <table class="results2 table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th>@Strings.getMSG("ProcesosAuditoriaIndexInformes002")</th>
                        <th>@Strings.getMSG("Entidad")</th>
                        <th>@Strings.getMSG("Menu148")</th>
                        <th>@Strings.getMSG("DivisionAuditoria001")</th>
                        <th>@Strings.getMSG("AuditoriaIndexUniversoAuditable002")</th>
                        <th>@Strings.getMSG("AuditoriaIndexSeguimientosPrograma004")</th>
                        <th>@Strings.getMSG("AuditoriaIndexSeguimientoObservaciones003")</th>
                        <th>@Strings.getMSG("Menu026")</th>
                        <th>@Strings.getMSG("BDEICreate005")</th>
                        <th>@Strings.getMSG("ProcesosAuditoriaEditPrueba004")</th>
                        <th>@Strings.getMSG("Responsable")</th>
                        <th>@Strings.getMSG("AuditoriaIndexSeguimientoObservaciones004")</th>
                        <th>@Strings.getMSG("lyPSeguimientoCreate002")</th>
                        <th>@Strings.getMSG("AuditoriaEditSeguimientoObservaciones006")</th>
                        <th>@Strings.getMSG("lyPSeguimientosIndex001")</th>
                        <th>@Strings.getMSG("RevisionControlRevisiones003")</th>
                        <th>@Strings.getMSG("RevisionControlRevisiones007")</th>
                        <th width="40"></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in atendidas)
                    {
                        var criticidad = item.c_criticidad_programa_trabajo ?? new SCIRA.Models.c_criticidad_programa_trabajo();
                        var estatus = item.c_estatus_programa_trabajo ?? new SCIRA.Models.c_estatus_programa_trabajo();

                        var seguimientos = item.k_comentario_programa_trabajo; 
                    <tr>
                        <td>
                            @item.k_auditoria.fe_inicial_planeada.Value.Year
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.k_auditoria.c_auditoria.c_entidad.nb_entidad)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.k_auditoria.c_auditoria.nb_auditoria)
                        </td>
                        <td>
                            @((item.k_auditoria.c_auditoria.id_division_auditoria ?? 0) != 0 ? item.k_auditoria.c_auditoria.c_division_auditoria.ds_division_auditoria : "N/A")
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.k_auditoria.c_auditoria.c_solicitante_auditoria.nb_solicitante_auditoria)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.incidencia_detectada)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.recomendaciones)
                        </td>
                        <td>
                            @(criticidad.nb_criticidad_programa_trabajo)
                        </td>
                        <td>
                            @(estatus.nb_estatus_programa_trabajo)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.tema)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.responsable)
                        </td>
                        <td>
                            @(item.es_duplicada ? Strings.getMSG("UsuarioIndex004"):Strings.getMSG("UsuarioIndex005"))
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.comentarios)
                        </td>
                        <td>
                            @(string.Format("{0:dd/MM/yyyy}", item.fe_resolucion))
                        </td>
                        <td>
                            @foreach (var s in seguimientos)
                            {
                                <b>@string.Format("{0:dd/MM/yyyy}", s.fe_comentario)</b>
                                <p><i>@s.nb_responsable</i> @s.comentario</p><br />
                            }
                        </td>
                        <td>
                            @foreach (var file in item.c_archivo1)
                            {
                                <a href="@Url.Action("Download","Archivos", new { id = file.id_archivo})"><i class="fa fa-file@(Utilidades.getFileClass(file))" title="@file.nb_archivo"></i></a>
                            }
                            @if (item.c_archivo1.Count() == 0)
                            {
                                @Strings.getMSG("AuditoriaIndexSeguimientoObservaciones007")
                            }
                        </td>
                        <td>
                            @foreach (var file in item.c_archivo1)
                            {
                                <p>@(file.nb_archivo+"."+file.extension)</p>
                            }
                            @if (item.c_archivo1.Count() == 0)
                            {
                                @Strings.getMSG("AuditoriaIndexSeguimientoObservaciones007")
                            }
                        </td>
                        <td>
                            <a href="@Url.Action("EditSeguimientoObservaciones", new { id = item.idd_programa_trabajo })">
                                <i class="glyphicon glyphicon-pencil" title="@Strings.getMSG("Editar")"></i>
                            </a>
                            |
                            <a href="@Url.Action("IndexSeguimientosPrograma", new { id = item.idd_programa_trabajo })">
                                <i class="fa fa-paw" title="@Strings.getMSG("lyPSeguimientosIndex001")"></i>
                            </a>
                        </td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>




<script>
    $(document).ready(function () {
        loadTables();
    });
</script>
