@model IEnumerable<SCIRA.Models.k_auditoria>
@using SCIRA.Utilidades
@{
    Layout = "~/Views/Shared/_LayoutReporte.cshtml";
    ViewBag.Title = "Ejecución";
}

<h2>@Strings.getMSG("Menu106")</h2>

<table id="results" class="results table table-striped table-bordered table-hover">
    <thead>
        <tr>
            <th>@Strings.getMSG("Entidad")</th>
            <th>@Strings.getMSG("DivisionAuditoria001")</th>
            <th>@Strings.getMSG("ProcesosAuditoriaIndexPlaneacion002")</th>
            <th>@Strings.getMSG("AuditoriaIndexUniversoAuditable001")</th>
            <th>@Strings.getMSG("ProcesosAuditoriaIndexPlaneacion001")</th>
            <th>@Strings.getMSG("ProcesosAuditoriaIndexPlaneacion002")</th>
            <th>@Strings.getMSG("ProcesosAuditoriaCreatePlaneacion002")</th>
            <th>@Strings.getMSG("ProcesosAuditoriaCreatePlaneacion003")</th>
            <th>@Strings.getMSG("ProcesosAuditoriaIndexEjecucion001")</th>
            <th>@Strings.getMSG("ProcesosAuditoriaIndexEjecucion002")</th>
            <th>@Strings.getMSG("ProcesosAuditoriaIndexPlaneacion005")</th>
            <th width="90">@Strings.getMSG("RevisionControlRevisiones003")</th>
            <th width="90"></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            var auditoria = item.c_auditoria;
            var entidad = auditoria.c_entidad;
            
        <tr>
            <td>@entidad.nb_entidad</td>
            <td>@((auditoria.id_division_auditoria ?? 0) != 0 ? auditoria.c_division_auditoria.ds_division_auditoria : "N/A")</td>
            <td>@(auditoria.nb_auditoria)</td>
            <td>@(auditoria.es_regulada ? Strings.getMSG("AuditoriaIndexUniversoAuditable006"):Strings.getMSG("AuditoriaIndexUniversoAuditable009"))</td>
            <td>@auditoria.c_solicitante_auditoria.nb_solicitante_auditoria</td>
            <td>@auditoria.nb_auditoria</td>
            <td>@(string.Format("{0:dd/MM/yyyy}",item.fe_inicial_planeada))</td>
            <td>@(string.Format("{0:dd/MM/yyyy}",item.fe_final_planeada))</td>
            <td>@(string.Format("{0:dd/MM/yyyy}",item.fe_inicial_real))</td>
            <td>@(string.Format("{0:dd/MM/yyyy}",item.fe_final_real))</td>
            <td>@item.no_horas_estimadas</td>
            <td>
                @foreach (var file in item.c_archivo)
                {
                    <a href="@Url.Action("Download","Archivos", new { id = file.id_archivo})"><i class="fa fa-file@(SCIRA.Utilidades.Utilidades.getFileClass(file))" title="@file.nb_archivo"></i></a>
                }
                @if (item.c_archivo.Count() == 0)
                {
                    @:@Strings.getMSG("ProcesosAuditoriaIndexEjecucion003")
                }
            </td>
            <td>
                <a href="@Url.Action("EditEjecucion", new { id = item.idd_auditoria })">
                    <i class="glyphicon glyphicon-pencil" title="@Strings.getMSG("Planeación detallada")"></i>
                </a> |
                <a href="@Url.Action("PruebasEjecucion", new { id = item.idd_auditoria})">
                    <i class="fa fa-file-text-o" title="@Strings.getMSG("AuditoriaIndexUniversoAuditable008")"></i>
                </a>
            </td>
        </tr>
        }
    </tbody>
</table>
