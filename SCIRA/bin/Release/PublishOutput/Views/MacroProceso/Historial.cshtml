@model IEnumerable<SCIRA.Models.r_macro_proceso>
@using SCIRA.Models
@using System.Reflection
@using SCIRA.Utilidades
@{
    int ncambios = Model.Count();
    c_macro_proceso mp = ViewBag.mp;
    r_macro_proceso mpA = Model.First();
    ViewBag.Title = @Strings.getMSG("MPHistorial005") + " " +  mp.nb_macro_proceso;
    Layout = "~/Views/Shared/_LayoutIndex.cshtml";
}
<link href="~/Content/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="~/Scripts/sharedScripts.js"></script>
<link href="~/Content/RiesgoResidual.css" rel="stylesheet" />

<script>
    function sleep(milliseconds) {
        var start = new Date().getTime();
        for (var i = 0; i < 1e7; i++) {
            if ((new Date().getTime() - start) > milliseconds) {
                break;
            }
        }
    }
</script>

<h2>@Strings.getMSG("MPHistorial005") @mp.cl_macro_proceso - @mp.nb_macro_proceso</h2>
<div>
    @Html.ActionLink(Strings.getMSG("Regresar"), "Index", "MacroProceso", new { @class = "btn btn-default" })
</div>
<br />
<br />
<br />

<ul class="nav nav-tabs">
    <li class="active"><a href="#pes1" data-toggle="tab"><h4>@Strings.getMSG("RiesgoHistorial001")</h4></a></li>
    <li><a href="#pes2" data-toggle="tab"><h4>@Strings.getMSG("MPHistorial002")</h4></a></li>
</ul>

<div id="myTabContent" class="tab-content">


    <div class="tab-pane fade active in" id="pes1">
        <div id="accordion">

            @for (int i = 0; i < Model.Count(); i++)
            {
                var registro = Model.ElementAt(i);
                r_macro_proceso anterior;
                if (i + 1 != Model.Count())
                {
                    anterior = Model.ElementAt(i + 1);
                }
                else
                {
                    anterior = registro;
                }

                <div class="card" id="11" w-75>
                    <div class="card-header" id="@registro.id_registro_macro_proceso">
                        <h5>
                            <button id="ps@(registro.id_registro_macro_proceso)" class="btn btn-default collapsed" data-toggle="collapse" data-target="#dt@(registro.id_registro_macro_proceso)" aria-expanded="false" aria-controls="dt@(registro.id_registro_macro_proceso)" style="display: block; width: 100%;">
                                @Strings.getMSG("RiesgoHistorial003") @registro.c_usuario.nb_usuario @Strings.getMSG("RiesgoHistorial007") @registro.fe_modificacion.Value.ToString("dd/MM/yyyy hh:mm:ss")
                            </button>
                        </h5>
                    </div>
                    <div id="dt@(registro.id_registro_macro_proceso)" class="collapse" aria-labelledby="@registro.c_usuario.nb_usuario" data-parent="#accordion">
                        <div class="card-body">
                            <table class="table table-bordered table-hover table-responsive table-striped">
                                <thead>
                                    <tr>
                                        <th>@Strings.getMSG("Campo")</th>
                                        <th>@Strings.getMSG("RiesgoResidualConfigIndex030")</th>
                                        <th>@Strings.getMSG("RiesgoHistorial004")</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>@Strings.getMSG("Entidad")</td>
                                        <td>@registro.nb_entidad</td>
                                        <td>@(registro.nb_entidad != anterior.nb_entidad ? Strings.getMSG("UsuarioIndex004") : Strings.getMSG("UsuarioIndex005"))</td>
                                    </tr>
                                    <tr>
                                        <td>@Strings.getMSG("Clave")</td>
                                        <td>@registro.cl_macro_proceso</td>
                                        <td>@(registro.cl_macro_proceso != anterior.cl_macro_proceso ? Strings.getMSG("UsuarioIndex004") : Strings.getMSG("UsuarioIndex005"))</td>
                                    </tr>
                                    <tr>
                                        <td>@Strings.getMSG("MP")</td>
                                        <td>@registro.nb_macro_proceso</td>
                                        <td>@(registro.nb_macro_proceso != anterior.nb_macro_proceso ? Strings.getMSG("UsuarioIndex004") : Strings.getMSG("UsuarioIndex005"))</td>
                                    </tr>
                                    <tr>
                                        <td>@Strings.getMSG("Responsable")</td>
                                        <td>@registro.nb_responsable</td>
                                        <td>@(registro.nb_responsable != anterior.nb_responsable ? Strings.getMSG("UsuarioIndex004") : Strings.getMSG("UsuarioIndex005"))</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            }

        </div>
    </div>


    <div class="tab-pane" id="pes2">
        <br /><br /><br />
        <table class="table table-bordered table-hover table-responsive table-striped">
            <thead>
                <tr>
                    <th>@Strings.getMSG("Campo")</th>
                    <th>@Strings.getMSG("RiesgoResidualConfigIndex030")</th>
                    <th>@Strings.getMSG("RiesgoHistorial004")</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>@Strings.getMSG("Entidad")</td>
                    <td>@mp.c_entidad.nb_entidad</td>
                    <td>@(mp.c_entidad.nb_entidad != mpA.nb_entidad ? Strings.getMSG("UsuarioIndex004") : Strings.getMSG("UsuarioIndex005"))</td>
                </tr>
                <tr>
                    <td>@Strings.getMSG("Clave")</td>
                    <td>@mp.cl_macro_proceso</td>
                    <td>@(mp.cl_macro_proceso != mpA.cl_macro_proceso ? Strings.getMSG("UsuarioIndex004") : Strings.getMSG("UsuarioIndex005"))</td>
                </tr>
                <tr>
                    <td>@Strings.getMSG("MP")</td>
                    <td>@mp.nb_macro_proceso</td>
                    <td>@(mp.nb_macro_proceso != mpA.nb_macro_proceso ? Strings.getMSG("UsuarioIndex004") : Strings.getMSG("UsuarioIndex005"))</td>
                </tr>
                <tr>
                    <td>@Strings.getMSG("Responsable")</td>
                    <td>@mp.c_usuario.nb_usuario</td>
                    <td>@(mp.c_usuario.nb_usuario != mpA.nb_responsable ? Strings.getMSG("UsuarioIndex004") : Strings.getMSG("UsuarioIndex005"))</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
