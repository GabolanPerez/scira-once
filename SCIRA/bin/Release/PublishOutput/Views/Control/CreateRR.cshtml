@model SCIRA.Models.k_riesgo_residual
@using SCIRA.Models
@using SCIRA.Utilidades
@{
    List<a_campo_cobertura_control> lccc = (List<a_campo_cobertura_control>)ViewBag.cccInfo ?? new List<a_campo_cobertura_control>();

    string m1 = "";
    string m2 = "";
    string m3 = "";
    string m4 = "";
    string m5 = "";
    string m6 = "";
    string m7 = "";
    string m8 = "";
    string m9 = "";

    string m10 = "";
    string m11 = "";
    string m12 = "";
    string m13 = "";
    string m14 = "";


    foreach (var item in lccc.Where(c => c.cl_catalogo == 1 && c.cl_campo == 1))
    {
        m1 = m1 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 1 && c.cl_campo == 2))
    {
        m2 = m2 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 1 && c.cl_campo == 3))
    {
        m3 = m3 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 1 && c.cl_campo == 4))
    {
        m4 = m4 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 1 && c.cl_campo == 5))
    {
        m5 = m5 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 1 && c.cl_campo == 6))
    {
        m6 = m6 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 1 && c.cl_campo == 7))
    {
        m7 = m7 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 1 && c.cl_campo == 8))
    {
        m8 = m8 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 1 && c.cl_campo == 9))
    {
        m9 = m9 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 2 && c.cl_campo == 1))
    {
        m10 = m10 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 2 && c.cl_campo == 2))
    {
        m11 = m11 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 2 && c.cl_campo == 3))
    {
        m12 = m12 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 2 && c.cl_campo == 4))
    {
        m13 = m13 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }
    foreach (var item in lccc.Where(c => c.cl_catalogo == 2 && c.cl_campo == 5))
    {
        m14 = m14 + "<br/><b>" + item.nb_campo + ":</b>" + item.ds_campo + "<br/>";
    }


}



<script>
    $(document).ready(function () {
        $('[data-toggle="popover"]').popover({
            container: 'body'
        });
    });
</script>

<br />
<div class="form-horizontal well">

    <div class="titleRR principalColor">@Strings.getMSG("ControlEdit003")</div>

    <div class="rrRow">
        <div class="cardRR cardRR1 principalColor"><br>@Strings.getMSG("ControlEdit003")</div>
        <div class="cardRR cardRR2 principalColor">@Strings.getMSG("Menu025")<br>*<br> @Strings.getMSG("Menu023")</div>
        <div class="betweenCard"><br><br><i class="fa fa-arrow-right"> </i></div>
        <div class="cardRR cardRR3 principalColor"><br>@ViewBag.Riesgo_Inherente</div>
    </div>

    @if (!ViewBag.readOnly)
    {
        <form id="formRR">
            @Html.AntiForgeryToken()
            @Html.HiddenFor(model => model.id_control)
            @if (ViewBag.Edit != null)
            {
                @Html.HiddenFor(model => model.id_riesgo_residual)
            }
            <div class="titleRR principalColor">@Strings.getMSG("ControlEdit007")</div>
            <div class="subtitleRR secundarioColor">@Strings.getMSG("RiesgoResidualConfigIndex002")</div>
            <br><br>



            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex005")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("dc_ejecucion_sistematica", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "El control se lleva a cabo con una frecuencia ya definida en los sistemas. <br/>" + m1 })
                        @Html.ValidationMessageFor(model => model.dc_ejecucion_sistematica, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex006")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("dc_pistas_auditoria", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "Existen adecuados registros de los cambios realizados al control (Fecha, nombre del usuario, detalle del cambio, etc.)<br/>" + m2 })
                        @Html.ValidationMessageFor(model => model.dc_pistas_auditoria, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex007")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("dc_cumplimiento_politicas_entidad", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "El control está alineado con los estándares de la industria y acordes a las políticas internas.<br/>" + m3 })
                        @Html.ValidationMessageFor(model => model.dc_cumplimiento_politicas_entidad, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex008")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("dc_umbrales_adecuados_indicadores", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "Que los umbrales definidos en los indicadores sean suficientes para garantizar una buena cobertura del control.<br/>" + m4 })
                        @Html.ValidationMessageFor(model => model.dc_umbrales_adecuados_indicadores, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("ControlEdit008")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("dc_metodologia_reporte", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "Metodología del procedimiento de haber escalado las fallas del control.<br/>" + m5 })
                        @Html.ValidationMessageFor(model => model.dc_metodologia_reporte, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex010")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("dc_evaluacion_diseño", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "Resultado de su certificación dependiendo de la criticidad de cada riesgo.<br/>" + m6 })
                        @Html.ValidationMessageFor(model => model.dc_evaluacion_diseño, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("ControlEdit009")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("dc_responsable_diseño", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "Adecuada estructura organizacional de los responsables del diseño del control.<br/>" + m7 })
                        @Html.ValidationMessageFor(model => model.dc_responsable_diseño, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex012")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("dc_entrada_datos", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "Dependiendo si la entrada de datos es manual o automática.<br/>" + m8 })
                        @Html.ValidationMessageFor(model => model.dc_entrada_datos, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex013")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("dc_resultado_sin_manipulacion", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "Los resultados del control no requieren manipulaciones adicionales.<br/>" + m9 })
                        @Html.ValidationMessageFor(model => model.dc_resultado_sin_manipulacion, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="subtitleRR secundarioColor">@Strings.getMSG("RiesgoResidualConfigIndex003")</div>
            <br><br>
            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex021")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("ec_planes_remediacion", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "Existen planes de remediación por todas las incidencias detectadas en los controles y no existen planes vencidos no atendidos.<br/>" + m10 })
                        @Html.ValidationMessageFor(model => model.ec_planes_remediacion, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex022")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("ec_eventos_relacionados", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "No existen pérdidas o posibles pérdidas relacionadas con la falla de controles y almacenadas en la BDEI.<br/>" + m11 })
                        @Html.ValidationMessageFor(model => model.ec_eventos_relacionados, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex023")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("ec_evaluacion_efectividad", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = @"En la parte de la validación de los controles estos funcionan adecuadamente. Las pruebas se realizarían como sigue:<br/>
    Riesgos Altos - Trimestral<br/>
    Riesgos Medios - Semestral<br/>
    Riesgos Bajos - Anual.<br/>" + m12 })
                        @Html.ValidationMessageFor(model => model.ec_evaluacion_efectividad, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex024")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("ec_efectividad_indicadores", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "Los indicadores deben funcionar adecuadamente y todas las alertas deberán ser atendidas a través de planes de remediación.<br/>" + m13 })
                        @Html.ValidationMessageFor(model => model.ec_efectividad_indicadores, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="form-group has-error">
                    <label class="control-label col-xs-3 col-md-2">@Strings.getMSG("RiesgoResidualConfigIndex025")</label>
                    <div class="col-xs-6 col-md-5">
                        @Html.DropDownList("ec_tiempo_madurez_control", null, htmlAttributes: new { @class = "form-control", @title = "Atención", data_toggle = "popover", data_trigger = "hover", data_html = "true", data_content = "El control mientras más tiempo tenga será más robusto por las pruebas que se hacen del mismo de manera periodica.<br/>" + m14 })
                        @Html.ValidationMessageFor(model => model.ec_tiempo_madurez_control, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>


            <div class="row">
                <div class="form-group">
                    <div class="col-md-offset-2 col-md-10">
                        @if (ViewBag.Edit != null)
                        {
                            <input type="button" value=@Strings.getMSG("Guardar") onclick="editarPostRR()" class="btn btn-primary submit" />
                        }
                        else
                        {
                            <input type="button" value=@Strings.getMSG("Guardar") onclick="enviarRR()" class="btn btn-primary submit" />
                        }



                    </div>
                </div>
            </div>



        </form>
    }
</div>
